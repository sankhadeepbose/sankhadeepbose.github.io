<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sankhadeep Bose – Publications</title>
  <!--
    Minimal academic website: publications page.
    Publications are loaded from a BibTeX file and formatted using Citation.js.
  -->
  <link rel="stylesheet" href="styles.css">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Academicons for Google Scholar icon -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css">
</head>
<body>
  <div class="container">
    <!-- Sidebar with photo and contact links -->
    <aside class="sidebar">
      <img src="images/profile.jpg" alt="Profile photo">
      <div class="contact-links">
        <!-- Google Scholar icon -->
        <a href="[https://scholar.google.com/citations?user=YOUR_ID]"
           title="Google Scholar" target="_blank" rel="noopener">
          <i class="ai ai-google-scholar-square"></i>
        </a>
        <!-- ResearchGate icon -->
        <a href="[https://www.researchgate.net/profile/YOUR_PROFILE]"
           title="ResearchGate" target="_blank" rel="noopener">
          <i class="fab fa-researchgate"></i>
        </a>
        <!-- LinkedIn icon -->
        <a href="[https://www.linkedin.com/in/yourprofile]"
           title="LinkedIn" target="_blank" rel="noopener">
          <i class="fab fa-linkedin"></i>
        </a>
        <!-- ORCID icon -->
        <a href="[https://orcid.org/0000-0000-0000-0000]"
           title="ORCID" target="_blank" rel="noopener">
          <i class="ai ai-orcid"></i>
        </a>
        <!-- GitHub icon -->
        <a href="[https://github.com/yourusername]"
           title="GitHub" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
      </div>
      <!-- Explicit email address below the icons -->
      <p class="contact-email">
        <i class="fas fa-envelope"></i> bose.sankhadeep@pm.me
      </p>
    </aside>

    <!-- Main content area -->
    <div class="main-content">
      <header>
        <h1>Sankhadeep Bose</h1>
        <p>PhD student specializing in Thermodynamics, Statistical Mechanics, and Atomistic Simulations.</p>
        <p><strong>Current Affiliation</strong> – School of Mechanical Engineering, Vellore Institute Of Technology, Vellore, Tamil Nadu, India.</p>
      </header>

      <!-- Primary navigation -->
      <nav>
        <ul>
          <li><a href="index.html">About</a></li>
          <li><a href="research.html">Research</a></li>
          <li><a href="publications.html" class="active">Publications</a></li>
        </ul>
      </nav>

      <main>
        <section id="publications">
          <h2>Publications</h2>
          <div id="pub-list">Loading publications…</div>
        </section>
      </main>

      <footer>
        <p>&copy; 2025 Sankhadeep Bose. All rights reserved.</p>
      </footer>
    </div>
  </div>

  <!-- Load Citation.js (monolithic bundle including BibTeX + CSL) -->
  <script src="https://cdn.jsdelivr.net/npm/citation-js@0.7.18/build/citation.min.js"></script>

  <script>
    /*
      Fetch the BibTeX file and render it as an HTML bibliography.
      We use the monolithic 'citation-js' bundle, which includes BibTeX and CSL
      plugins, so template: 'apa' works.
    */
    const Cite = require('citation-js');

    async function loadPublications() {
      const container = document.getElementById('pub-list');

      try {
        const response = await fetch('publications.bib');
        if (!response.ok) {
          throw new Error('Network response was not ok (status ' + response.status + ')');
        }

        let bibText = await response.text();

        // Remove comment lines that start with '%'
        bibText = bibText.replace(/^\s*%.*$/gm, '').trim();
        if (!bibText) {
          throw new Error('BibTeX file is empty after removing comments.');
        }

        // Split the BibTeX text into individual entries on lines that start with '@'
        const rawEntries = bibText.split(/\n@/).filter(e => e.trim());
        const entries = rawEntries.map(entry => {
          const trimmed = entry.trim();
          return trimmed.startsWith('@') ? trimmed : '@' + trimmed;
        });

        // Categorise entries into peer-reviewed articles and theses, capturing year for sorting.
        const categories = { peer: [], thesis: [] };

        entries.forEach(entry => {
          const typeMatch = entry.match(/^@(\w+)/i);
          const type = typeMatch ? typeMatch[1].toLowerCase() : '';
          const yearMatch = entry.match(/year\s*=\s*\{?(\d{4})/i);
          const year = yearMatch ? parseInt(yearMatch[1], 10) : 0;

          if (type === 'article') {
            categories.peer.push({ entry, year });
          } else if (type.includes('thesis')) {
            categories.thesis.push({ entry, year });
          } else {
            // Fallback: treat unknown types as peer-reviewed
            categories.peer.push({ entry, year });
          }
        });

        // Sort each category by descending year
        const sortDesc = (a, b) => b.year - a.year;
        categories.peer.sort(sortDesc);
        categories.thesis.sort(sortDesc);

        // Clear the container before rendering
        container.innerHTML = '';

        // Helper to render one category with a heading and reversed numbering
        const renderList = (items, headingText) => {
          if (!items.length) return;

          const h3 = document.createElement('h3');
          h3.textContent = headingText;
          container.appendChild(h3);

          const ol = document.createElement('ol');
          // reversed numbering: largest number at the top
          ol.setAttribute('reversed', '');
          ol.start = items.length;

          items.forEach(({ entry }) => {
            // Use Citation.js to format each entry in APA style
            const cite = new Cite(entry);
            const html = cite.format('bibliography', {
              format: 'html',
              template: 'apa',
              lang: 'en-US'
            });

            const temp = document.createElement('div');
            temp.innerHTML = html;
            const cslEntry = temp.querySelector('.csl-entry') || temp;

            const li = document.createElement('li');
            li.innerHTML = cslEntry.innerHTML;
            ol.appendChild(li);
          });

          container.appendChild(ol);
        };

        // Render peer-reviewed journals and theses
        renderList(categories.peer, 'In Peer-Reviewed Journals');
        renderList(categories.thesis, 'Theses');
      } catch (err) {
        console.error('Failed to load publications:', err);
        container.textContent = 'Unable to load publications. Please check your .bib file.';
      }
    }

    document.addEventListener('DOMContentLoaded', loadPublications);
  </script>
</body>
</html>
